<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Proven Inconclusive</title><link href="http://proven-inconclusive.com/" rel="alternate"></link><link href="http://proven-inconclusive.com/feeds/tag.r.atom.xml" rel="self"></link><id>http://proven-inconclusive.com/</id><updated>2015-02-03T00:00:00+01:00</updated><entry><title>QuickTip: Utilizing Machine Learning Methods to Identify Important Variables</title><link href="http://proven-inconclusive.com/blog/machine_learning_methods_to_identify_important_variables.html" rel="alternate"></link><updated>2015-02-03T00:00:00+01:00</updated><author><name>Hinrich B. Winther</name></author><id>tag:proven-inconclusive.com,2015-02-03:blog/machine_learning_methods_to_identify_important_variables.html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;Machine Learning is the field of scientific study that concentrates on induction algorithms and on other algorithms that can be said to “learn.” &lt;span class="citation" data-cites="_glossary_1998"&gt;[1]&lt;/span&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In order to identify important variables in a multivariate dataset one can utilize machine learning methods. There are many different machine learning algorithms for different tasks. One common task is to decide if a feature vector belongs to a certain class. This can be done with a random forest &lt;span class="citation" data-cites="breiman_random_2001"&gt;[2]&lt;/span&gt; classifier. In order to do so, one has to train the classifier with training data first. Then the classifier can be used to predict the class of other feature vectors. For demonstration purposes we will use the &lt;a href="https://stat.ethz.ch/R-manual/R-patched/library/datasets/html/iris.html"&gt;iris data set&lt;/a&gt;. The following R code loads the &amp;quot;randomForest&amp;quot; library and trains a classifier (forest) with the iris data set. The &amp;quot;Species&amp;quot; column is set as the training label.&lt;/p&gt;
&lt;pre class="sourceCode R"&gt;&lt;code class="sourceCode r"&gt;&amp;gt;&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;library&lt;/span&gt;(randomForest)
&amp;gt;&lt;span class="st"&gt; &lt;/span&gt;forest =&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;randomForest&lt;/span&gt;(Species~., &lt;span class="dt"&gt;data=&lt;/span&gt;iris, &lt;span class="dt"&gt;importance=&lt;/span&gt;&lt;span class="ot"&gt;TRUE&lt;/span&gt;)
&amp;gt;&lt;span class="st"&gt; &lt;/span&gt;
&lt;span class="er"&gt;&amp;gt;&lt;/span&gt;&lt;span class="st"&gt; &lt;/span&gt;forest

Call:
&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;randomForest&lt;/span&gt;(&lt;span class="dt"&gt;formula=&lt;/span&gt;Species ~&lt;span class="st"&gt; &lt;/span&gt;., &lt;span class="dt"&gt;data=&lt;/span&gt;iris, &lt;span class="dt"&gt;importance=&lt;/span&gt;&lt;span class="ot"&gt;TRUE&lt;/span&gt;) 
               Type of random forest:&lt;span class="st"&gt; &lt;/span&gt;classification
                     Number of trees:&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="dv"&gt;500&lt;/span&gt;
No. of variables tried at each split:&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="dv"&gt;2&lt;/span&gt;

        OOB estimate of  error rate:&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="fl"&gt;4.67&lt;/span&gt;%
Confusion matrix:
&lt;span class="st"&gt;           &lt;/span&gt;setosa versicolor virginica class.error
setosa         &lt;span class="dv"&gt;50&lt;/span&gt;          &lt;span class="dv"&gt;0&lt;/span&gt;         &lt;span class="dv"&gt;0&lt;/span&gt;        &lt;span class="fl"&gt;0.00&lt;/span&gt;
versicolor      &lt;span class="dv"&gt;0&lt;/span&gt;         &lt;span class="dv"&gt;47&lt;/span&gt;         &lt;span class="dv"&gt;3&lt;/span&gt;        &lt;span class="fl"&gt;0.06&lt;/span&gt;
virginica       &lt;span class="dv"&gt;0&lt;/span&gt;          &lt;span class="dv"&gt;4&lt;/span&gt;        &lt;span class="dv"&gt;46&lt;/span&gt;        &lt;span class="fl"&gt;0.08&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In this example the classifier achieves an out-of-bag (oob) error rate of 4.67%. There is no need for other tests, such as cross-validation, to get an unbiased estimate of the test set error as each tree is created with a different bootstrap sample &lt;span class="citation" data-cites="breiman_random_2001"&gt;[2]&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The classifier saves information on feature importance (&amp;quot;importance=TRUE&amp;quot;). We can use this information in order to identify potentially import variables in the data set. The following R code extracts this information from the classifier and visualizes the data using ggplot2.&lt;/p&gt;
&lt;pre class="sourceCode R"&gt;&lt;code class="sourceCode r"&gt;&amp;gt;&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;library&lt;/span&gt;(ggplot2)
&amp;gt;&lt;span class="st"&gt; &lt;/span&gt;forest.importance =&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;as.data.frame&lt;/span&gt;(&lt;span class="kw"&gt;importance&lt;/span&gt;(forest, &lt;span class="dt"&gt;scale=&lt;/span&gt;&lt;span class="ot"&gt;FALSE&lt;/span&gt;))
&amp;gt;&lt;span class="st"&gt; &lt;/span&gt;forest.importance =&lt;span class="st"&gt; &lt;/span&gt;forest.importance[,&lt;span class="dv"&gt;1&lt;/span&gt;:(&lt;span class="kw"&gt;ncol&lt;/span&gt;(forest.importance)-&lt;span class="dv"&gt;2&lt;/span&gt;)]
&amp;gt;&lt;span class="st"&gt; &lt;/span&gt;forest.importance$mean =&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;rowMeans&lt;/span&gt;(forest.importance)
&amp;gt;
&lt;span class="er"&gt;&amp;gt;&lt;/span&gt;&lt;span class="st"&gt; &lt;/span&gt;forest.importance&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;Table 1: Feature importance table with calculated mean column.&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: left;"&gt;feature&lt;/th&gt;
&lt;th style="text-align: right;"&gt;setosa&lt;/th&gt;
&lt;th style="text-align: right;"&gt;versicolor&lt;/th&gt;
&lt;th style="text-align: right;"&gt;virginica&lt;/th&gt;
&lt;th style="text-align: right;"&gt;mean&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;Sepal.Length&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.031&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.025&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.046&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.034&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;Sepal.Width&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.008&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.003&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.011&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.007&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;Petal.Length&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.349&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.322&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.324&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.332&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;Petal.Width&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.305&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.289&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.267&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.287&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class="sourceCode R"&gt;&lt;code class="sourceCode r"&gt;&lt;span class="kw"&gt;ggplot&lt;/span&gt;(forest.importance, &lt;span class="kw"&gt;aes&lt;/span&gt;(&lt;span class="dt"&gt;x=&lt;/span&gt;&lt;span class="kw"&gt;row.names&lt;/span&gt;(forest.importance), &lt;span class="dt"&gt;y=&lt;/span&gt;mean)) +
&lt;span class="st"&gt;  &lt;/span&gt;&lt;span class="kw"&gt;ylab&lt;/span&gt;(&lt;span class="st"&gt;&amp;#39;mean relative feature importance&amp;#39;&lt;/span&gt;) +
&lt;span class="st"&gt;  &lt;/span&gt;&lt;span class="kw"&gt;xlab&lt;/span&gt;(&lt;span class="st"&gt;&amp;#39;feature&amp;#39;&lt;/span&gt;) +
&lt;span class="st"&gt;  &lt;/span&gt;&lt;span class="kw"&gt;geom_bar&lt;/span&gt;(&lt;span class="dt"&gt;stat=&lt;/span&gt;&lt;span class="st"&gt;&amp;#39;identity&amp;#39;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;figure&gt;
&lt;img src="http://proven-inconclusive.com/images/R/ml_mean_relative_feature_importance.svg" alt="Figure 1: Mean relative feature importance learned by a random forest classifier on the iris data set." /&gt;&lt;figcaption&gt;Figure 1: Mean relative feature importance learned by a random forest classifier on the iris data set.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;div class="references"&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;p&gt;1. Glossary of terms. Machine Learning [Internet] 1998 Feb [cited 2015 Feb 3TZ];30(2-3):271–274. Available from: &lt;a href="http://link.springer.com/article/10.1023/A%3A1017181826899"&gt;http://link.springer.com/article/10.1023/A%3A1017181826899&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2. Breiman L. Random forests. Machine Learning [Internet] 2001 Oct [cited 2015 Feb 3TZ];45(1):5–32. Available from: &lt;a href="http://link.springer.com/article/10.1023/A%3A1010933404324"&gt;http://link.springer.com/article/10.1023/A%3A1010933404324&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</summary><category term='"scientific writing"'></category><category term='"R"'></category><category term='"QuickTip"'></category></entry><entry><title>Spearman Correlation Heat Map with Correlation Coefficients and Significance Levels in R</title><link href="http://proven-inconclusive.com/blog/spearman_correlation_heat_map_with_correlation_coefficient_and_significance_in_r.html" rel="alternate"></link><updated>2015-02-03T00:00:00+01:00</updated><author><name>Hinrich B. Winther</name></author><id>tag:proven-inconclusive.com,2014-10-24:blog/spearman_correlation_heat_map_with_correlation_coefficient_and_significance_in_r.html</id><summary type="html">&lt;figure&gt;
&lt;img src="http://proven-inconclusive.com/images/R/spearman_correlation_heatmap_mtcars.svg" alt="Figure 1: Spearman correlation heat map with correlation coefficient and significance levels based on the mtcars data set." /&gt;&lt;figcaption&gt;Figure 1: Spearman correlation heat map with correlation coefficient and significance levels based on the mtcars data set.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;In a recent paper we included data from a survey we conducted. During the publication process, one of the reviewers asked for a more in depth statistical analysis of the data set. He (she?) explicitly expressed a special interest in correlating the variables of the survey in order to spot any interesting correlations. This posed a number of problems:&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;&lt;p&gt;The data set has 35 variables. This translates into a huge correlation matrix.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There are many ways to correlate variables. In my field the &lt;a href="http://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient"&gt;Pearson product-moment correlation coefficient (Pearson's r)&lt;/a&gt; and the &lt;a href="http://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient"&gt;Spearman's rank correlation coefficient (Spearman's rho)&lt;/a&gt; are the most common ones. Which one should I choose and why?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Correlations by themselves are not very useful. You, most likely, want to have at least some information about the statistical significance of the correlation.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="the-data-set"&gt;The Data Set&lt;/h3&gt;
&lt;p&gt;For the sake of demonstration we will use the &lt;a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html"&gt;mtcars&lt;/a&gt; data set, provided by the &lt;a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/00Index.html"&gt;stats&lt;/a&gt; package. The data set includes 11 variables with 32 observations, hence rendering the task a bit more manageable.&lt;/p&gt;
&lt;table&gt;
&lt;caption&gt;Table 1: The first five (of 32) observations of the mtcars data set.&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: left;"&gt;&lt;/th&gt;
&lt;th style="text-align: right;"&gt;mpg&lt;/th&gt;
&lt;th style="text-align: right;"&gt;cyl&lt;/th&gt;
&lt;th style="text-align: right;"&gt;disp&lt;/th&gt;
&lt;th style="text-align: right;"&gt;hp&lt;/th&gt;
&lt;th style="text-align: right;"&gt;drat&lt;/th&gt;
&lt;th style="text-align: right;"&gt;wt&lt;/th&gt;
&lt;th style="text-align: right;"&gt;qsec&lt;/th&gt;
&lt;th style="text-align: right;"&gt;vs&lt;/th&gt;
&lt;th style="text-align: right;"&gt;am&lt;/th&gt;
&lt;th style="text-align: right;"&gt;gear&lt;/th&gt;
&lt;th style="text-align: right;"&gt;carb&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;Mazda RX4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;21.0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;6&lt;/td&gt;
&lt;td style="text-align: right;"&gt;160.0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;110&lt;/td&gt;
&lt;td style="text-align: right;"&gt;3.90&lt;/td&gt;
&lt;td style="text-align: right;"&gt;2.620&lt;/td&gt;
&lt;td style="text-align: right;"&gt;16.46&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1&lt;/td&gt;
&lt;td style="text-align: right;"&gt;4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;Mazda RX4 Wag&lt;/td&gt;
&lt;td style="text-align: right;"&gt;21.0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;6&lt;/td&gt;
&lt;td style="text-align: right;"&gt;160.0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;110&lt;/td&gt;
&lt;td style="text-align: right;"&gt;3.90&lt;/td&gt;
&lt;td style="text-align: right;"&gt;2.875&lt;/td&gt;
&lt;td style="text-align: right;"&gt;17.02&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1&lt;/td&gt;
&lt;td style="text-align: right;"&gt;4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;Datsun 710&lt;/td&gt;
&lt;td style="text-align: right;"&gt;22.8&lt;/td&gt;
&lt;td style="text-align: right;"&gt;4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;108.0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;93&lt;/td&gt;
&lt;td style="text-align: right;"&gt;3.85&lt;/td&gt;
&lt;td style="text-align: right;"&gt;2.320&lt;/td&gt;
&lt;td style="text-align: right;"&gt;18.61&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1&lt;/td&gt;
&lt;td style="text-align: right;"&gt;4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;Hornet 4 Drive&lt;/td&gt;
&lt;td style="text-align: right;"&gt;21.4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;6&lt;/td&gt;
&lt;td style="text-align: right;"&gt;258.0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;110&lt;/td&gt;
&lt;td style="text-align: right;"&gt;3.08&lt;/td&gt;
&lt;td style="text-align: right;"&gt;3.215&lt;/td&gt;
&lt;td style="text-align: right;"&gt;19.44&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;3&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;Hornet Sportabout&lt;/td&gt;
&lt;td style="text-align: right;"&gt;18.7&lt;/td&gt;
&lt;td style="text-align: right;"&gt;8&lt;/td&gt;
&lt;td style="text-align: right;"&gt;360.0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;175&lt;/td&gt;
&lt;td style="text-align: right;"&gt;3.15&lt;/td&gt;
&lt;td style="text-align: right;"&gt;3.440&lt;/td&gt;
&lt;td style="text-align: right;"&gt;17.02&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0&lt;/td&gt;
&lt;td style="text-align: right;"&gt;3&lt;/td&gt;
&lt;td style="text-align: right;"&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;caption&gt;Table 2: Description of the variable labels of the mtcars data set.&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: left;"&gt;axis&lt;/th&gt;
&lt;th style="text-align: left;"&gt;description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;mpg&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Miles/(US) gallon&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;cyl&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Number of cylinders&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;disp&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Displacement (cu.in.)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;hp&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Gross horsepower&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;drat&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Rear axle ratio&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;wt&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Weight (lb/1000)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;qsec&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1/4 mile time&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;vs&lt;/td&gt;
&lt;td style="text-align: left;"&gt;V/S&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;am&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Transmission (0 = automatic, 1 = manual)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;gear&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Number of forward gears&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;carb&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Number of carburetors&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="choosing-a-suitable-correlation-algorithm"&gt;Choosing a Suitable Correlation Algorithm&lt;/h3&gt;
&lt;p&gt;As most papers in my field use either Pearson's r or Spearman's rho I began my research there. As it turns out, there are two types of algorithms: parametric and non-parametric. Parametric algorithms depend on some assumptions about the data set. In case of Pearson's r you need to know about the distribution, scaling and dependency of the variables of the data set.&lt;/p&gt;
&lt;p&gt;Spearman's rho, on the other hand, is a non-parametric algorithm. It compares two ranked variables of either &lt;a href="http://en.wikipedia.org/wiki/Level_of_measurement"&gt;ordinal, interval or ratio&lt;/a&gt; type and describes how well they can be described using a monotonic function. No further assumptions on the data set are necessary which is handy if you do not know too much about the distribution of your data.&lt;/p&gt;
&lt;h3 id="lets-get-started"&gt;Let's Get Started!&lt;/h3&gt;
&lt;p&gt;&lt;a href="http://www.r-project.org"&gt;R&lt;/a&gt;, a statistical computing programming language, is being used for the statistical analysis with some additional libraries: &lt;a href="http://ggplot2.org"&gt;ggplot2&lt;/a&gt; for plotting, &lt;a href="http://biostat.mc.vanderbilt.edu/wiki/Main/Hmisc"&gt;Hmisc&lt;/a&gt; to create a correlation matrix, &lt;a href="https://github.com/hadley/reshape"&gt;reshape2&lt;/a&gt; to meld the data frame as well as &lt;a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/00Index.html"&gt;stats&lt;/a&gt; to provide the &lt;a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html"&gt;mtcars&lt;/a&gt; data set.&lt;/p&gt;
&lt;pre class="sourceCode R"&gt;&lt;code class="sourceCode r"&gt;&lt;span class="kw"&gt;library&lt;/span&gt;(ggplot2)
&lt;span class="kw"&gt;library&lt;/span&gt;(reshape2)
&lt;span class="kw"&gt;library&lt;/span&gt;(Hmisc)
&lt;span class="kw"&gt;library&lt;/span&gt;(stats)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The first thing is to calculate the correlation of the individual variables to another. As we have our data already in a data frame, merely a call of the rcorr function of the Hmisc library is necessary. This creates a new list with two entries: ”r” the correlation coefficients and ”P” the significance levels.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;rcorr Computes a matrix of Pearson's r or Spearman's rho rank correlation coefficients for all possible pairs of columns of a matrix. Missing values are deleted in pairs rather than deleting all rows of x having any missing variables. Ranks are computed using efficient algorithms, using midranks for ties.&lt;br /&gt; -- R Documentation / rcorr {Hmisc}&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre class="sourceCode R"&gt;&lt;code class="sourceCode r"&gt;d &amp;lt;-&lt;span class="st"&gt; &lt;/span&gt;mtcars
cormatrix =&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;rcorr&lt;/span&gt;(&lt;span class="kw"&gt;as.matrix&lt;/span&gt;(d), &lt;span class="dt"&gt;type=&lt;/span&gt;&lt;span class="st"&gt;&amp;#39;spearman&amp;#39;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;Table 3: Resulting correlation matrix - correlation coefficients (cormatrix$r)&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: left;"&gt;&lt;/th&gt;
&lt;th style="text-align: right;"&gt;mpg&lt;/th&gt;
&lt;th style="text-align: right;"&gt;cyl&lt;/th&gt;
&lt;th style="text-align: right;"&gt;disp&lt;/th&gt;
&lt;th style="text-align: right;"&gt;hp&lt;/th&gt;
&lt;th style="text-align: right;"&gt;drat&lt;/th&gt;
&lt;th style="text-align: right;"&gt;wt&lt;/th&gt;
&lt;th style="text-align: right;"&gt;qsec&lt;/th&gt;
&lt;th style="text-align: right;"&gt;vs&lt;/th&gt;
&lt;th style="text-align: right;"&gt;am&lt;/th&gt;
&lt;th style="text-align: right;"&gt;gear&lt;/th&gt;
&lt;th style="text-align: right;"&gt;carb&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;mpg&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.91&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.91&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.89&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.65&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.89&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.47&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.71&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.56&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.54&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.66&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;cyl&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.91&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.93&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.90&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.68&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.86&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.57&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.81&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.52&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.56&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.58&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;disp&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.91&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.93&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.85&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.68&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.90&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.46&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.72&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.62&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.59&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.54&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;hp&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.89&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.90&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.85&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.52&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.77&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.67&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.75&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.36&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.33&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.73&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;drat&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.65&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.68&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.68&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.52&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.75&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.09&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.45&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.69&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.74&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.13&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;wt&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.89&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.86&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.90&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.77&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.75&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.23&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.59&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.74&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.68&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;qsec&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.47&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.57&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.46&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.67&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.09&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.23&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.79&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.20&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.15&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.66&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;vs&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.71&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.81&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.72&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.75&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.45&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.59&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.79&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.17&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.28&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.63&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;am&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.56&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.52&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.62&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.36&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.69&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.74&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.20&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.17&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.81&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.06&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;gear&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.54&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.56&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.59&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.33&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.74&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.68&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.15&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.28&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.81&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;carb&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.66&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.58&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.54&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.73&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.13&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.50&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.66&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.63&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.06&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.11&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.00&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;caption&gt;Table 4: Resulting correlation matrix - significance levels (cormatrix$P)&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th style="text-align: left;"&gt;&lt;/th&gt;
&lt;th style="text-align: right;"&gt;mpg&lt;/th&gt;
&lt;th style="text-align: right;"&gt;cyl&lt;/th&gt;
&lt;th style="text-align: right;"&gt;disp&lt;/th&gt;
&lt;th style="text-align: right;"&gt;hp&lt;/th&gt;
&lt;th style="text-align: right;"&gt;drat&lt;/th&gt;
&lt;th style="text-align: right;"&gt;wt&lt;/th&gt;
&lt;th style="text-align: right;"&gt;qsec&lt;/th&gt;
&lt;th style="text-align: right;"&gt;vs&lt;/th&gt;
&lt;th style="text-align: right;"&gt;am&lt;/th&gt;
&lt;th style="text-align: right;"&gt;gear&lt;/th&gt;
&lt;th style="text-align: right;"&gt;carb&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;mpg&lt;/td&gt;
&lt;td style="text-align: right;"&gt;NA&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.01&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;cyl&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;NA&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;disp&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;NA&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.01&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;hp&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;NA&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.04&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.06&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;drat&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;NA&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.62&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.01&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.49&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;wt&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;NA&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.21&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;qsec&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.01&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.01&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.62&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.21&lt;/td&gt;
&lt;td style="text-align: right;"&gt;NA&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.26&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.42&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;vs&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.01&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;NA&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.36&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.12&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;am&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.04&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.26&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.36&lt;/td&gt;
&lt;td style="text-align: right;"&gt;NA&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.73&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td style="text-align: left;"&gt;gear&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.06&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.42&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.12&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;NA&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.53&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td style="text-align: left;"&gt;carb&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.49&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.00&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.73&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.53&lt;/td&gt;
&lt;td style="text-align: right;"&gt;NA&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The correlation coefficients can be plotted using a heat map representation. &lt;a href="http://ggplot2.org"&gt;ggplot2&lt;/a&gt; provides the &lt;a href="http://docs.ggplot2.org/current/geom_tile.html"&gt;geom_tile&lt;/a&gt; geometric object for this purpose. In order to plot the correlation matrix we need to &lt;a href="http://www.wekaleamstudios.co.uk/posts/melt/"&gt;meld&lt;/a&gt; the data frame first.&lt;/p&gt;
&lt;pre class="sourceCode R"&gt;&lt;code class="sourceCode r"&gt;cordata =&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;melt&lt;/span&gt;(cormatrix$r)
&lt;span class="kw"&gt;ggplot&lt;/span&gt;(cordata, &lt;span class="kw"&gt;aes&lt;/span&gt;(&lt;span class="dt"&gt;x=&lt;/span&gt;Var1, &lt;span class="dt"&gt;y=&lt;/span&gt;Var2, &lt;span class="dt"&gt;fill=&lt;/span&gt;value)) +&lt;span class="st"&gt; &lt;/span&gt;
&lt;span class="st"&gt;  &lt;/span&gt;&lt;span class="kw"&gt;geom_tile&lt;/span&gt;() +&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;xlab&lt;/span&gt;(&lt;span class="st"&gt;&amp;quot;&amp;quot;&lt;/span&gt;) +&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;ylab&lt;/span&gt;(&lt;span class="st"&gt;&amp;quot;&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;figure&gt;
&lt;img src="http://proven-inconclusive.com/images/R/spearman_correlation_heatmap_mtcars_bare.svg" alt="Figure 2: Spearman correlation heat map based on the mtcars data set. No information about significance levels is included" /&gt;&lt;figcaption&gt;Figure 2: Spearman correlation heat map based on the mtcars data set. No information about significance levels is included&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Figure 2 shows the resulting heat map, plotted by ggplot2. However, some key data is missing. There is no information about the significance levels nor does the plot include the numeric values of Spearman's rho. In order to efficiently use the little space per tile, I wrote a little function (&amp;quot;abbreviateSTR&amp;quot;) which abbreviates the values. The resulting strings are stored in a label column. This column can then be plotted onto the corresponding tile. To further enhance the distinction between significant (P &amp;gt; 0.05) and insignificant correlations, a red, semi transparent, ”X” is being overlaid onto insignificant tiles. The resulting plot is shown in figure 1.&lt;/p&gt;
&lt;h3 id="conclusion"&gt;Conclusion&lt;/h3&gt;
&lt;p&gt;By using the non-parametric Spearman algorithm it is possible to create a preliminary overview of the correlations within a data set. This information can be plotted utilizing a heat map representation in conjunction with significance levels as well as numeric values of Spearman's rho. The resulting plot is a comprehensible representation of the data set, which allows quick identification of significant correlations.&lt;/p&gt;
&lt;p&gt;Looking at the heat map, one could get the impression that the gross horsepower has a strong negative correlation (r ≈ -0.89, P &amp;lt; 0.01) with the gasoline consumption. Who would have thought?&lt;/p&gt;
&lt;h3 id="complete-r-script"&gt;Complete R Script&lt;/h3&gt;
&lt;pre class="sourceCode R"&gt;&lt;code class="sourceCode r"&gt;&lt;span class="co"&gt;#!/usr/bin/env Rscript&lt;/span&gt;

&lt;span class="kw"&gt;library&lt;/span&gt;(ggplot2)
&lt;span class="kw"&gt;library&lt;/span&gt;(reshape2)
&lt;span class="kw"&gt;library&lt;/span&gt;(Hmisc)
&lt;span class="kw"&gt;library&lt;/span&gt;(stats)

abbreviateSTR &amp;lt;-&lt;span class="st"&gt; &lt;/span&gt;function(value, prefix){  &lt;span class="co"&gt;# format string more concisely&lt;/span&gt;
  lst =&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;c&lt;/span&gt;()
  for (item in value) {
    if (&lt;span class="kw"&gt;is.nan&lt;/span&gt;(item) ||&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;is.na&lt;/span&gt;(item)) { &lt;span class="co"&gt;# if item is NaN return empty string&lt;/span&gt;
      lst &amp;lt;-&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;c&lt;/span&gt;(lst, &lt;span class="st"&gt;&amp;#39;&amp;#39;&lt;/span&gt;)
      next
    }
    item &amp;lt;-&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;round&lt;/span&gt;(item, &lt;span class="dv"&gt;2&lt;/span&gt;) &lt;span class="co"&gt;# round to two digits&lt;/span&gt;
    if (item ==&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="dv"&gt;0&lt;/span&gt;) { &lt;span class="co"&gt;# if rounding results in 0 clarify&lt;/span&gt;
      item =&lt;span class="st"&gt; &amp;#39;&amp;lt;.01&amp;#39;&lt;/span&gt;
    }
    item &amp;lt;-&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;as.character&lt;/span&gt;(item)
    item &amp;lt;-&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;sub&lt;/span&gt;(&lt;span class="st"&gt;&amp;quot;(^[0])+&amp;quot;&lt;/span&gt;, &lt;span class="st"&gt;&amp;quot;&amp;quot;&lt;/span&gt;, item)    &lt;span class="co"&gt;# remove leading 0: 0.05 -&amp;gt; .05&lt;/span&gt;
    item &amp;lt;-&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;sub&lt;/span&gt;(&lt;span class="st"&gt;&amp;quot;(^-[0])+&amp;quot;&lt;/span&gt;, &lt;span class="st"&gt;&amp;quot;-&amp;quot;&lt;/span&gt;, item)  &lt;span class="co"&gt;# remove leading -0: -0.05 -&amp;gt; -.05&lt;/span&gt;
    lst &amp;lt;-&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;c&lt;/span&gt;(lst, &lt;span class="kw"&gt;paste&lt;/span&gt;(prefix, item, &lt;span class="dt"&gt;sep =&lt;/span&gt; &lt;span class="st"&gt;&amp;quot;&amp;quot;&lt;/span&gt;))
  }
  &lt;span class="kw"&gt;return&lt;/span&gt;(lst)
}

d &amp;lt;-&lt;span class="st"&gt; &lt;/span&gt;mtcars

cormatrix =&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;rcorr&lt;/span&gt;(&lt;span class="kw"&gt;as.matrix&lt;/span&gt;(d), &lt;span class="dt"&gt;type=&lt;/span&gt;&lt;span class="st"&gt;&amp;#39;spearman&amp;#39;&lt;/span&gt;)
cordata =&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;melt&lt;/span&gt;(cormatrix$r)
cordata$labelr =&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;abbreviateSTR&lt;/span&gt;(&lt;span class="kw"&gt;melt&lt;/span&gt;(cormatrix$r)$value, &lt;span class="st"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;)
cordata$labelP =&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;abbreviateSTR&lt;/span&gt;(&lt;span class="kw"&gt;melt&lt;/span&gt;(cormatrix$P)$value, &lt;span class="st"&gt;&amp;#39;P&amp;#39;&lt;/span&gt;)
cordata$label =&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;paste&lt;/span&gt;(cordata$labelr, &lt;span class="st"&gt;&amp;quot;&lt;/span&gt;&lt;span class="ch"&gt;\n&lt;/span&gt;&lt;span class="st"&gt;&amp;quot;&lt;/span&gt;, 
                      cordata$labelP, &lt;span class="dt"&gt;sep =&lt;/span&gt; &lt;span class="st"&gt;&amp;quot;&amp;quot;&lt;/span&gt;)
cordata$strike =&lt;span class="st"&gt; &amp;quot;&amp;quot;&lt;/span&gt;
cordata$strike[cormatrix$P &amp;gt;&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="fl"&gt;0.05&lt;/span&gt;] =&lt;span class="st"&gt; &amp;quot;X&amp;quot;&lt;/span&gt;

txtsize &amp;lt;-&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;par&lt;/span&gt;(&lt;span class="st"&gt;&amp;#39;din&amp;#39;&lt;/span&gt;)[&lt;span class="dv"&gt;2&lt;/span&gt;] /&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="dv"&gt;2&lt;/span&gt;
&lt;span class="kw"&gt;ggplot&lt;/span&gt;(cordata, &lt;span class="kw"&gt;aes&lt;/span&gt;(&lt;span class="dt"&gt;x=&lt;/span&gt;Var1, &lt;span class="dt"&gt;y=&lt;/span&gt;Var2, &lt;span class="dt"&gt;fill=&lt;/span&gt;value)) +&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;geom_tile&lt;/span&gt;() +&lt;span class="st"&gt; &lt;/span&gt;
&lt;span class="st"&gt;  &lt;/span&gt;&lt;span class="kw"&gt;theme&lt;/span&gt;(&lt;span class="dt"&gt;axis.text.x =&lt;/span&gt; &lt;span class="kw"&gt;element_text&lt;/span&gt;(&lt;span class="dt"&gt;angle=&lt;/span&gt;&lt;span class="dv"&gt;90&lt;/span&gt;, &lt;span class="dt"&gt;hjust=&lt;/span&gt;&lt;span class="ot"&gt;TRUE&lt;/span&gt;)) +
&lt;span class="st"&gt;  &lt;/span&gt;&lt;span class="kw"&gt;xlab&lt;/span&gt;(&lt;span class="st"&gt;&amp;quot;&amp;quot;&lt;/span&gt;) +&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="kw"&gt;ylab&lt;/span&gt;(&lt;span class="st"&gt;&amp;quot;&amp;quot;&lt;/span&gt;) +&lt;span class="st"&gt; &lt;/span&gt;
&lt;span class="st"&gt;  &lt;/span&gt;&lt;span class="kw"&gt;geom_text&lt;/span&gt;(&lt;span class="dt"&gt;label=&lt;/span&gt;cordata$label, &lt;span class="dt"&gt;size=&lt;/span&gt;txtsize) +&lt;span class="st"&gt; &lt;/span&gt;
&lt;span class="st"&gt;  &lt;/span&gt;&lt;span class="kw"&gt;geom_text&lt;/span&gt;(&lt;span class="dt"&gt;label=&lt;/span&gt;cordata$strike, &lt;span class="dt"&gt;size=&lt;/span&gt;txtsize *&lt;span class="st"&gt; &lt;/span&gt;&lt;span class="dv"&gt;4&lt;/span&gt;, &lt;span class="dt"&gt;color=&lt;/span&gt;&lt;span class="st"&gt;&amp;quot;red&amp;quot;&lt;/span&gt;, &lt;span class="dt"&gt;alpha=&lt;/span&gt;&lt;span class="fl"&gt;0.4&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;div class="references"&gt;

&lt;/div&gt;
</summary><category term='"scientific writing"'></category><category term='"R"'></category></entry></feed>